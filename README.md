# ä¼ä¸šåˆåŒå®¡æ ¸ä»£ç†ç³»ç»Ÿ

åŸºäºMastraæ¡†æ¶æ„å»ºçš„æ™ºèƒ½åˆåŒå®¡æ ¸ç³»ç»Ÿï¼Œä¸“é—¨ç”¨äºå®¡æ ¸å¯è§†åŒ–å¤§å±ä¼ä¸šåˆåŒçš„åˆè§„æ€§ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹ç‚¹

### æ™ºèƒ½åˆåŒå®¡æ ¸
- **è‡ªåŠ¨åˆè§„æ£€æŸ¥**ï¼šå…¨é¢æ£€æŸ¥æ•°æ®å®‰å…¨ã€çŸ¥è¯†äº§æƒã€SLAç­‰å…³é”®æ¡æ¬¾
- **é£é™©ç­‰çº§è¯„ä¼°**ï¼šå››çº§é£é™©åˆ†ç±»ï¼ˆä½ã€ä¸­ã€é«˜ã€ä¸¥é‡ï¼‰
- **åˆè§„æ€§è¯„åˆ†**ï¼š0-100åˆ†é‡åŒ–è¯„ä¼°ä½“ç³»
- **ä¸“ä¸šå»ºè®®ç”Ÿæˆ**ï¼šé’ˆå¯¹æ€§æ”¹è¿›å»ºè®®å’Œæ“ä½œæŒ‡å—

### ğŸ“„ æ–‡ä»¶å¤„ç†èƒ½åŠ›
- **PDFæ–‡ä»¶æ”¯æŒ**ï¼šæ™ºèƒ½è§£æPDFåˆåŒæ–‡æ¡£
- **TXTæ–‡ä»¶æ”¯æŒ**ï¼šå¤„ç†çº¯æ–‡æœ¬åˆåŒæ–‡ä»¶
- **DOCXåŸºç¡€æ”¯æŒ**ï¼šæœ‰é™çš„DOCXæ–‡ä»¶è§£æï¼ˆæ¨èè½¬æ¢ä¸ºPDFï¼‰
- **æ–‡ä»¶ä¸Šä¼ API**ï¼šæ”¯æŒWebç•Œé¢ç›´æ¥ä¸Šä¼ æ–‡ä»¶å®¡æ ¸

### ä¸“ä¸šå®¡æ ¸é¢†åŸŸ
- ğŸ”’ **æ•°æ®å®‰å…¨ä¸éšç§ä¿æŠ¤**ï¼šGDPRã€ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•åˆè§„
- ğŸ“‹ **çŸ¥è¯†äº§æƒä¿æŠ¤**ï¼šIPå½’å±å’Œä½¿ç”¨æƒé™å®¡æ ¸
- âš¡ **æœåŠ¡ç­‰çº§åè®®**ï¼šæ€§èƒ½æŒ‡æ ‡å’Œå¯ç”¨æ€§ä¿è¯
- âš–ï¸ **è´£ä»»é™åˆ¶ä¸èµ”å¿**ï¼šé£é™©åˆ†æ‹…æœºåˆ¶è¯„ä¼°
- ğŸ› ï¸ **æŠ€æœ¯è§„èŒƒè¦æ±‚**ï¼šæ¥å£æ ‡å‡†å’Œæ•°æ®æ ¼å¼éªŒè¯
- ğŸ¨ **ç”¨æˆ·ä½“éªŒæ ‡å‡†**ï¼šç•Œé¢è®¾è®¡å’Œå¯è®¿é—®æ€§è§„èŒƒ

### ä¿ç•™åŠŸèƒ½
- ğŸŒ¤ï¸ **å¤©æ°”æŸ¥è¯¢ä»£ç†**ï¼šä¿ç•™åŸæœ‰å¤©æ°”æŸ¥è¯¢åŠŸèƒ½

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ mastra/
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ weather-agent.ts          # å¤©æ°”æŸ¥è¯¢ä»£ç†ï¼ˆä¿ç•™ï¼‰
â”‚   â”‚   â””â”€â”€ contract-audit-agent.ts   # åˆåŒå®¡æ ¸ä»£ç†ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ weather-tool.ts           # å¤©æ°”æŸ¥è¯¢å·¥å…·ï¼ˆä¿ç•™ï¼‰
â”‚   â”‚   â”œâ”€â”€ contract-audit-tool.ts    # åˆåŒå®¡æ ¸å·¥å…·ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ file-parser-tool.ts       # æ–‡ä»¶è§£æå·¥å…·ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â””â”€â”€ contract-file-audit-tool.ts # æ–‡ä»¶åˆåŒå®¡æ ¸å·¥å…·ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ workflows/
â”‚   â”‚   â”œâ”€â”€ weather-workflow.ts       # å¤©æ°”å·¥ä½œæµï¼ˆä¿ç•™ï¼‰
â”‚   â”‚   â””â”€â”€ contract-audit-workflow.ts # åˆåŒå®¡æ ¸å·¥ä½œæµï¼ˆæ–°å¢ï¼‰
â”‚   â””â”€â”€ index.ts                      # ä¸»é…ç½®æ–‡ä»¶
docs/
â”œâ”€â”€ contract-audit-workflow-guide.md  # å·¥ä½œæµä½¿ç”¨æŒ‡å—
â””â”€â”€ file-upload-api-guide.md         # æ–‡ä»¶ä¸Šä¼ APIæŒ‡å—
```

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 20.9.0
- npm æˆ– yarn

### å®‰è£…ä¾èµ–
```bash
npm install
```

### ç¯å¢ƒé…ç½®
åˆ›å»º `.env` æ–‡ä»¶å¹¶é…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼š

```bash
# AIæ¨¡å‹é…ç½®
DEEPSEEK_API_KEY=your_deepseek_api_key

# Cloudflareéƒ¨ç½²é…ç½®ï¼ˆå¯é€‰ï¼‰
CLOUDFLARE_API_TOKEN=your_cloudflare_token
CLOUDFLARE_ACCOUNT_ID=your_account_id
```

### å¼€å‘è¿è¡Œ
```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»ºé¡¹ç›®
npm run build

# å¯åŠ¨æœåŠ¡
npm run start
```

### éƒ¨ç½²åˆ°Cloudflare
```bash
npm run deploy
```

## ğŸ’» ä½¿ç”¨ç¤ºä¾‹

### ğŸ“„ æ–‡ä»¶ä¸Šä¼ å®¡æ ¸ï¼ˆæ¨èï¼‰

```typescript
import { mastra } from './src/mastra';

// å¤„ç†PDF/TXTæ–‡ä»¶ä¸Šä¼ å®¡æ ¸
const handleFileUpload = async (file: File) => {
  const fileBuffer = await file.arrayBuffer();
  
  const result = await mastra.runTool('contractFileAuditTool', {
    fileBuffer,
    fileName: file.name,
    contractType: 'visualization_dashboard',
    contractId: 'VD-2024-001',
    mimeType: file.type,
  });
  
  return result;
};
```

### ğŸ“ æ–‡æœ¬å†…å®¹å®¡æ ¸

```typescript
import { contractAuditAgent } from './src/mastra/agents/contract-audit-agent';

// å®¡æ ¸æ–‡æœ¬åˆåŒå†…å®¹
const result = await contractAuditAgent.run({
  input: "è¯·å®¡æ ¸è¿™ä»½å¯è§†åŒ–å¤§å±åˆåŒ",
  context: {
    contractContent: `
      æ•°æ®å¯è§†åŒ–æœåŠ¡åˆåŒ
      
      ç”²æ–¹ï¼šXXç§‘æŠ€æœ‰é™å…¬å¸
      ä¹™æ–¹ï¼šYYä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸
      
      æœåŠ¡å†…å®¹ï¼šä¼ä¸šæ•°æ®å¯è§†åŒ–å¤§å±å¼€å‘
      æŠ€æœ¯è¦æ±‚ï¼šå®æ—¶æ•°æ®æ›´æ–°ã€å“åº”å¼è®¾è®¡
      æ•°æ®å¤„ç†ï¼šä¸¥æ ¼ä¿æŠ¤æ•°æ®å®‰å…¨...
    `,
    contractType: "visualization_dashboard",
    contractId: "VD-2024-001"
  }
});
```

### ğŸ”„ å·¥ä½œæµå®¡æ ¸

```typescript
// ä½¿ç”¨å®Œæ•´å·¥ä½œæµè¿›è¡ŒåˆåŒå®¡æ ¸
const workflowResult = await mastra.runWorkflow('contract-audit-workflow', {
  contractContent: 'åˆåŒå†…å®¹...',
  contractType: 'visualization_dashboard',
  contractId: 'VD-2024-001'
});
```

### ğŸŒ¤ï¸ å¤©æ°”æŸ¥è¯¢ï¼ˆä¿ç•™åŠŸèƒ½ï¼‰

```typescript
import { weatherAgent } from './src/mastra/agents/weather-agent';

// å¤©æ°”æŸ¥è¯¢
const result = await weatherAgent.run({
  input: "åŒ—äº¬ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
});
```

## ğŸ“‹ æ”¯æŒçš„æ–‡ä»¶æ ¼å¼

| æ ¼å¼ | æ”¯æŒç¨‹åº¦ | è¯´æ˜ |
|------|----------|------|
| PDF | âœ… å®Œå…¨æ”¯æŒ | é€šè¿‡è‡ªå®šä¹‰è§£æå™¨æå–æ–‡æœ¬å†…å®¹ |
| TXT | âœ… å®Œå…¨æ”¯æŒ | ç›´æ¥è¯»å–æ–‡æœ¬å†…å®¹ |
| DOCX | âš ï¸ æœ‰é™æ”¯æŒ | åŸºç¡€XMLè§£æï¼Œå»ºè®®è½¬æ¢ä¸ºPDF |
| DOC | âŒ ä¸æ”¯æŒ | è¯·è½¬æ¢ä¸ºDOCXæˆ–PDFæ ¼å¼ |

**æ–‡ä»¶é™åˆ¶**ï¼š
- æœ€å¤§æ–‡ä»¶å¤§å°ï¼š10MB
- æ”¯æŒä¸­è‹±æ–‡å†…å®¹
- è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç±»å‹

## ğŸ“Š å®¡æ ¸æŠ¥å‘Šç¤ºä¾‹

### æ–‡ä»¶å®¡æ ¸ç»“æœ

```json
{
  "contractId": "VD-2024-001",
  "contractType": "visualization_dashboard",
  "overallRiskLevel": "medium",
  "complianceScore": 75,
  "summary": "å¯è§†åŒ–å¤§å±åˆåŒæ–‡ä»¶åˆè§„å®¡æ ¸å®Œæˆã€‚åˆè§„å¾—åˆ†ï¼š75åˆ†ï¼Œé£é™©ç­‰çº§ï¼šä¸­ç­‰é£é™©",
  "criticalIssues": [
    "çŸ¥è¯†äº§æƒ: çŸ¥è¯†äº§æƒå½’å±æœªæ˜ç¡®"
  ],
  "recommendations": [
    "æ˜ç¡®å¯è§†åŒ–å¤§å±çš„çŸ¥è¯†äº§æƒå½’å±",
    "æ·»åŠ æ•°æ®ä¿æŠ¤æ¡æ¬¾",
    "å®Œå–„SLAæœåŠ¡ç­‰çº§åè®®"
  ],
  "fileMetadata": {
    "fileName": "contract.pdf",
    "fileType": "application/pdf",
    "fileSize": 245760,
    "pageCount": 5,
    "wordCount": 1248
  }
}
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### æ–‡ä»¶å¤„ç†å·¥å…·
- **`file-parser-tool.ts`**: è§£æPDFã€TXTã€DOCXæ–‡ä»¶
- **`contract-file-audit-tool.ts`**: é›†æˆæ–‡ä»¶è§£æå’Œåˆè§„å®¡æ ¸

### åˆåŒå®¡æ ¸å·¥å…·
- **`contract-audit-tool.ts`**: æ ¸å¿ƒåˆè§„æ£€æŸ¥é€»è¾‘
- **`contract-audit-agent.ts`**: æ™ºèƒ½å¯¹è¯å®¡æ ¸åŠ©æ‰‹

### å·¥ä½œæµç³»ç»Ÿ
- **`contract-audit-workflow.ts`**: å®Œæ•´çš„ä¸‰æ­¥å®¡æ ¸æµç¨‹
  1. é¢„å¤„ç†åˆåŒå†…å®¹
  2. æ‰§è¡Œåˆè§„å®¡æ ¸
  3. ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š

### å¤©æ°”åŠŸèƒ½ï¼ˆä¿ç•™ï¼‰
- **`weather-agent.ts`**: å¤©æ°”æŸ¥è¯¢ä»£ç†
- **`weather-tool.ts`**: å¤©æ°”æŸ¥è¯¢å·¥å…·
- **`weather-workflow.ts`**: å¤©æ°”å·¥ä½œæµ

## ğŸ¯ åˆè§„æ£€æŸ¥é¡¹ç›®

### åŸºç¡€æ£€æŸ¥
- âœ… æ•°æ®ä¿æŠ¤æ¡æ¬¾
- âœ… çŸ¥è¯†äº§æƒå½’å±
- âœ… æœåŠ¡ç­‰çº§åè®®
- âœ… è´£ä»»é™åˆ¶æ¡æ¬¾

### å¯è§†åŒ–å¤§å±ä¸“é¡¹æ£€æŸ¥
- âœ… æ•°æ®æ¥æºåˆæ³•æ€§
- âœ… æŠ€æœ¯æ ‡å‡†è¦æ±‚
- âœ… ç”¨æˆ·ä½“éªŒæ ‡å‡†

## ğŸ“ˆ é£é™©ç­‰çº§æ ‡å‡†

| ç­‰çº§ | è¯„åˆ† | æè¿° |
|------|------|------|
| ğŸŸ¢ ä½é£é™© | 85-100 | åˆè§„æ€§è‰¯å¥½ï¼Œé£é™©å¯æ§ |
| ğŸŸ¡ ä¸­ç­‰é£é™© | 70-84 | å­˜åœ¨åˆè§„é—®é¢˜ï¼Œå»ºè®®ä¼˜åŒ– |
| ğŸŸ  é«˜é£é™© | 50-69 | æ˜æ˜¾åˆè§„ç¼ºé™·ï¼Œéœ€é‡ç‚¹å…³æ³¨ |
| ğŸ”´ ä¸¥é‡é£é™© | 0-49 | é‡å¤§åˆè§„é£é™©ï¼Œå¿…é¡»å¤„ç† |

## ğŸŒ APIé›†æˆ

### æ–‡ä»¶ä¸Šä¼ ç«¯ç‚¹

```bash
POST /api/audit-contract-file
Content-Type: multipart/form-data

# å‚æ•°:
# - contract: æ–‡ä»¶ (PDF/TXT/DOCX)
# - contractType: åˆåŒç±»å‹
# - contractId: åˆåŒç¼–å·ï¼ˆå¯é€‰ï¼‰
```

### å“åº”æ ¼å¼

```typescript
interface ApiResponse {
  success: boolean;
  data?: AuditResult;
  error?: string;
}
```

è¯¦ç»†çš„APIä½¿ç”¨æŒ‡å—è¯·å‚è€ƒ [æ–‡ä»¶ä¸Šä¼ APIæŒ‡å—](./docs/file-upload-api-guide.md)ã€‚

## ğŸ”„ ç‰ˆæœ¬æ›´æ–°

### v2.0.1 - æ–‡ä»¶å¤„ç†ä¼˜åŒ–
- ğŸ”§ ä¿®å¤Cloudflare Workerséƒ¨ç½²å…¼å®¹æ€§é—®é¢˜
- ğŸ“„ ä¼˜åŒ–PDF/TXTæ–‡ä»¶è§£ææ€§èƒ½
- ğŸ›¡ï¸ å¢å¼ºæ–‡ä»¶å®‰å…¨éªŒè¯

### v2.0.0 - æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- âœ¨ æ–°å¢æ–‡ä»¶ä¸Šä¼ å’Œè§£æåŠŸèƒ½
- ğŸ“„ æ”¯æŒPDFã€TXTã€DOCXæ–‡ä»¶æ ¼å¼
- ğŸŒ æä¾›å®Œæ•´çš„æ–‡ä»¶ä¸Šä¼ API
- ğŸ¯ é’ˆå¯¹Cloudflare Workersç¯å¢ƒä¼˜åŒ–

### v1.0.0 - åˆåŒå®¡æ ¸åŠŸèƒ½
- âœ¨ æ–°å¢åˆåŒå®¡æ ¸ä»£ç†å’Œå·¥å…·
- ğŸ”’ ä¸“ä¸šçš„å¯è§†åŒ–å¤§å±åˆåŒåˆè§„æ€§æ£€æŸ¥
- ğŸ“Š æ™ºèƒ½é£é™©è¯„ä¼°å’Œåˆè§„è¯„åˆ†
- ğŸ’¡ è‡ªåŠ¨ç”Ÿæˆæ”¹è¿›å»ºè®®
- ğŸ”„ å®Œæ•´çš„å·¥ä½œæµç³»ç»Ÿ
- ğŸŒ¤ï¸ ä¿æŒå¤©æ°”æŸ¥è¯¢åŠŸèƒ½å…¼å®¹æ€§

## ğŸš¨ éƒ¨ç½²æ³¨æ„äº‹é¡¹

### Cloudflare Workerså…¼å®¹æ€§
- æ–‡ä»¶å¤„ç†åº“è®¾ä¸ºå¯é€‰ä¾èµ–ï¼Œé¿å…éƒ¨ç½²å†²çª
- ä½¿ç”¨Web APIå…¼å®¹çš„æ–‡ä»¶è§£ææ–¹æ³•
- ä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œæ”¯æŒå¤§æ–‡ä»¶å¤„ç†

### ç¯å¢ƒé…ç½®
```bash
# å¿…éœ€ç¯å¢ƒå˜é‡
DEEPSEEK_API_KEY=your_api_key

# å¯é€‰ï¼ˆç”¨äºéƒ¨ç½²ï¼‰
CLOUDFLARE_API_TOKEN=your_token
CLOUDFLARE_ACCOUNT_ID=your_account_id
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ ISC è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

- ğŸ“§ é‚®ç®±æ”¯æŒï¼šJzq1020814597@gmail.com
- ğŸ› é—®é¢˜åé¦ˆï¼š[GitHub Issues](https://github.com/juzhiqiang/recodeAgent/issues)
- ğŸ“– è¯¦ç»†æ–‡æ¡£ï¼š
  - [åˆåŒå®¡æ ¸å·¥ä½œæµæŒ‡å—](./docs/contract-audit-workflow-guide.md)
  - [æ–‡ä»¶ä¸Šä¼ APIæŒ‡å—](./docs/file-upload-api-guide.md)

## ğŸ”® æœªæ¥è§„åˆ’

- [ ] æ”¯æŒæ›´å¤šæ–‡ä»¶æ ¼å¼ï¼ˆExcelã€Wordç­‰ï¼‰
- [ ] å¢åŠ OCRå›¾åƒæ–‡å­—è¯†åˆ«
- [ ] é›†æˆæ›´å¤šæ³•å¾‹æ•°æ®åº“
- [ ] æ”¯æŒæ‰¹é‡åˆåŒå®¡æ ¸
- [ ] æ·»åŠ å¯è§†åŒ–æŠ¥å‘ŠåŠŸèƒ½
- [ ] Webç•Œé¢å¼€å‘
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] APIå¯†é’¥ç®¡ç†
- [ ] å®¡æ ¸å†å²è®°å½•

## ğŸ“Š ä½¿ç”¨ç»Ÿè®¡

- æ”¯æŒåˆåŒç±»å‹ï¼š5ç§
- åˆè§„æ£€æŸ¥é¡¹ç›®ï¼š7ä¸ªåŸºç¡€ + 3ä¸ªä¸“é¡¹
- æ–‡ä»¶æ ¼å¼æ”¯æŒï¼šPDFã€TXTã€DOCX
- æœ€å¤§æ–‡ä»¶å¤§å°ï¼š10MB
- éƒ¨ç½²ç¯å¢ƒï¼šCloudflare Workerså…¼å®¹

---

**æ³¨æ„**ï¼šAIå®¡æ ¸ç»“æœä»…ä¾›å‚è€ƒï¼Œé‡è¦åˆåŒå»ºè®®å’¨è¯¢ä¸“ä¸šå¾‹å¸ˆè¿›è¡Œæœ€ç»ˆç¡®è®¤ã€‚æœ¬ç³»ç»Ÿå·²é’ˆå¯¹Cloudflare Workersç¯å¢ƒä¼˜åŒ–ï¼Œç¡®ä¿ç¨³å®šçš„äº‘ç«¯éƒ¨ç½²å’Œå¿«é€Ÿå“åº”ã€‚